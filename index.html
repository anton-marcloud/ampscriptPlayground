<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AMP Script Playground</title>

    <!-- Google Tag Manager -->
    <script>(function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-NNLKND2');</script>
    <!-- End Google Tag Manager -->

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Anton&family=Barlow+Condensed:ital,wght@0,300;1,300&display=swap"
        rel="stylesheet">

    <style>
        * {
            box-sizing: border-box;
            position: relative;
            padding: 0;
            margin: 0;
            --lightest: #f0eff3;
            --light: #D8D2E1;
            --mid: #b07a79;
            --dark: #34435E;
            font: normal 18px/1.6 'Barlow Condensed', sans-serif;
        }

        .termsfeed-com---palette-light.termsfeed-com---nb {
            position: fixed;
        }

        #open_preferences_center {
            position: fixed;
            left: 0;
            bottom: 0;
            z-index: 1;
            background-color: var(--lightest);
            padding: 0.5em 1em;
            border: 2px solid var(--light);
            border-width: 2px 2px 0 0;
            border-radius: 0 5px 0 0;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        ul,
        li {
            list-style-type: none;
        }

        body {
            background-color: var(--lightest);
            color: var(--dark);
        }

        header {
            background-color: var(--mid);
            color: var(--lightest);
        }

        nav {
            margin: 0 auto;
            padding: 1rem 3vw;
            max-width: 1499px;
        }

        nav ul {
            display: flex;
        }

        nav ul li {
            padding: 0 2em 0 0;
        }

        main {
            padding: 3rem 3vw;
            min-height: 80vh;
        }

        h1 {
            color: var(--mid);
            font: normal 2.4rem/1.2 'Anton', sans-serif;
            padding: 0 0 1em;
            text-align: center;
        }

        .form-box {
            max-width: 1024px;
            margin: 0 auto;
            background-color: var(--light);
            padding: 1.5em 1em;
            border-radius: 20px;
        }

        footer {
            background-color: var(--light);
        }

        .footer-inner {
            margin: 0 auto;
            padding: 2rem 3vw;
            max-width: 1499px;
            text-align: center;
        }
    </style>

</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NNLKND2" height="0" width="0"
            style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <!-- Cookie Consent by TermsFeed https://www.TermsFeed.com -->
    <script type="text/javascript" src="//www.termsfeed.com/public/cookie-consent/4.0.0/cookie-consent.js"
        charset="UTF-8"></script>
    <script type="text/javascript" charset="UTF-8">
        document.addEventListener('DOMContentLoaded', function () {
            cookieconsent.run({ "notice_banner_type": "headline", "consent_type": "express", "palette": "light", "language": "en", "page_load_consent_levels": ["strictly-necessary"], "notice_banner_reject_button_hide": false, "preferences_center_close_button_hide": false, "page_refresh_confirmation_buttons": false, "website_name": "Snail Trail" });
        });
    </script>

    <noscript>Free cookie consent management tool by <a href="https://www.termsfeed.com/"
            rel="nofollow noopener">TermsFeed Policy Generator</a></noscript>
    <!-- End Cookie Consent by TermsFeed https://www.TermsFeed.com -->


    <!-- Below is the link that users can use to open Preferences Center to change their preferences. Do not modify the ID parameter. Place it where appropriate, style it as needed. -->

    <a href="#" id="open_preferences_center">Update cookies preferences</a>


    <header>
        <nav>
            <ul>
                <li><a href="/">Index</a></li>
                <li><a href="example1.html">Example link 1</a></li>
                <li><a href="example2.html">Example link 3</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <H1>üêå TEST PAGE 1 üêå</H1>
        <noscript> %%[
            SET @key= RequestParameter("key")

            ]%%

            %%= v(@key) =%%
        </noscript>
        <div class="form-box">
            <iframe src="https://go.www.snailtrail.uk/l/346332/2022-11-29/q9v8k" width="100%" height="350"
                type="text/html" frameborder="0" allowTransparency="true" style="border: 0"></iframe>
        </div>
        
        <button onclick="changeMe()" >Click me</button>

    </main>
    <footer>
        <div class="footer-inner">
            <p>Copyright</p>
        </div>
    </footer>

    <script>

        function changeMe() {
            const myIframe = document.querySelector('iframe');
            let iframeWindow = myIframe.contentWindow;
            console.log(iframeWindow.document);

        }


        function getParameterByName(name) {
            name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
            let regexS = "[\\?&]" + name + "=([^&#]*)";
            let regex = new RegExp(regexS);
            let results = regex.exec(window.location.search);
            if (results == null) {
                return "";
            } else {
                return decodeURIComponent(results[1].replace(/\+/g, " "));
            }
        }

        function setCookie(cName, cValue, expDays) {
            let date = new Date();
            date.setTime(date.getTime() + (expDays * 24 * 60 * 60 * 1000));
            const expires = "expires=" + date.toUTCString();
            document.cookie = cName + "=" + cValue + "; " + expires + '; path=/' + '; domain=' + location.hostname + '; secure';
        }

        function getCookie(cname) {
            let name = cname + "=";
            let decodedCookie = decodeURIComponent(document.cookie);
            let ca = decodedCookie.split(';');
            for (let i = 0; i < ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) == ' ') {
                    c = c.substring(1);
                }
                if (c.indexOf(name) == 0) {
                    return c.substring(name.length, c.length);
                }
            }
            return "";
        }

        (function () {
            let iframe = document.querySelectorAll('iframe');
            let pSource = getParameterByName('utm_source').toLowerCase();
            let pMedium = getParameterByName('utm_medium').toLowerCase();
            let pCampaign = getParameterByName('utm_campaign').toLowerCase();
            let pContent = getParameterByName('utm_content').toLowerCase();
            let pTerm = getParameterByName('utm_term').toLowerCase();
            let pGclid = getParameterByName('gclid');
            let pagePath = window.location.pathname.split('/').filter(e => e).slice(-1);

            setCookie('pageUrl', window.location.pathname.split('/').filter(e => e).slice(-1), 3650);

            if (getParameterByName('utm_source') || getParameterByName('gclid')) {
                setCookie('utmTracking', '?utm_source=' + pSource + '&utm_medium=' + pMedium + '&utm_campaign=' + pCampaign + '&utm_content=' + pContent + '&utm_term=' + pTerm + '&gclid=' + pGclid + '&last_utm_source=' + pSource + '&last_utm_medium=' + pMedium + '&last_utm_campaign=' + pCampaign + '&last_utm_content=' + pContent + '&last_utm_term=' + pTerm + '&last_gclid=' + pGclid, 3650);
            } else { }
            if (getCookie('utmTracking')) {
                for (ind = 0; ind < iframe.length; ind++) {
                    iframe[ind].src = iframe[ind].src + getCookie('utmTracking') + '&FSU=' + getCookie('pageUrl') + '&LSU=' + getCookie('pageUrl');
                }
            } else {
                for (ind = 0; ind < iframe.length; ind++) {
                    iframe[ind].src = iframe[ind].src + '?FSU=' + getCookie('pageUrl') + '&LSU=' + getCookie('pageUrl');
                }
            }
        })();
    </script>

    <script type='text/javascript'>
        piAId = '347332';
        piCId = '';
        piHostname = 'go.www.snailtrail.uk';

        (function () {
            function async_load() {
                var s = document.createElement('script'); s.type = 'text/javascript';
                s.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + piHostname + '/pd.js';
                var c = document.getElementsByTagName('script')[0]; c.parentNode.insertBefore(s, c);
            }
            if (window.attachEvent) { window.attachEvent('onload', async_load); }
            else { window.addEventListener('load', async_load, false); }
        })();
    </script>
</body>

</html>